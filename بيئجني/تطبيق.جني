ئورد مكون، مستند، عنصرمخصص؛
ئورد تخزينجلسة من ئساسية.نافدة؛
ئورد بتشدبي، معلوقاب، نتجقاب من مكون.بتشدبي؛
ئورد الكل ك قاعدب من قاعدب؛
ئورد فونت من مكون.فونت؛
ئورد الكل ك ئتيلات من ئتيلات؛
ئورد الكل ك سياق من سياق؛
ئورد الكل ك جيزن من جيزن؛
ئورد جلسة؛

ئعلن تطبيق ():
	يمدد مكون()؛
	هدا._حالة = {
		صفحة: 'تحميل'
	}؛
تم

ئعلن تطبيق.صيير ():
	دع صفحة = هدا._حالة.صفحة؛
	ئرجع (
		<فونت ئسم="كاسكاديامونو" عنونت="/ملفا/كسكاديامونو.ttf"></فونت>
		<شرط>
			<عند تحقق="هدا._حالة.صفحة == 'ئستيقان'">
				<ئستيقان></ئستيقان>
			</عند>
			<عند تحقق="هدا._حالة.صفحة == 'ئستقبال'">
				<ئستقبال></ئستقبال>
			</عند>
			<عند غيره>
				<قسم صنف="مخطط ط-كامل خلف-ئسود ئصفف-وسط ئرصف-وسط">
					<صورة مصدر="/ملفا/شعار.svg" عرض="130"></صورة>
				</قسم>
			</عند>
		</شرط>
	)؛
تم

#ئعلن _تطبيق.سججل ():
#	عنصرمخصص.سججل("تطبيق"، تطبيق)؛
#	مستند.جسم.ئشتملداخلي = "<x-تطبيق></x-تطبيق>"؛
#تم

ئعلن تطبيق.حممل () ك وعد فارغ:
	دع هلقاب = ريتما قاعدب.هلقاعدب()؛
	ئدا ليس هلقاب:
		# القاعدب فارغة، هدا ئول فتح للتطبيق، ئلا الئستقبال
		قل 'لا توجد قاعدب'؛
		هدا.خدحالة({صفحة: 'ئستقبال'})؛
	وئلا:
		جلسة.مستخدم = جيزن.مننصية(تخزينجلسة.ردعنصر('جني_مستيقن'))؛ #ك مختطمستخدم؛
		# لدينا قاعدب هل تم الئستيقان
		ئدا جلسة == عدم:
			هدا.خدحالة({صفحة: 'ئستيقان'})؛
			ئرجع؛
		تم
		# حسن نحن مستيقنين
		# تحميل الشركة
		نتجقاب نتج = ريتما قاعدب.محلي.ئستعلم(حدد: {نوع: 'شركة'})؛
		جلسة.شركة = نتج.وتيقات[0]؛
		#بدئ المزامنة
		قاعدب.زامنقاعدب(جلسة.شركة.رمزشركة)؛
		قل 'يزامن'؛
		جلسة.معرفمشروع = تخزينجلسة.ردعنصر('جني_معرفمشروع')؛
		جلسة.معرفنسخة = تخزينجلسة.ردعنصر('جني_معرفنسخة')؛
		ئدا جلسة.معرفمشروع:
			جلسة.مشروع = ريتما قاعدب.محلي.ئجلب(جلسة.معرفمشروع)؛
			جلسة.نسخة = ريتما قاعدب.محلي.ئجلب(جلسة.معرفنسخة)؛
		تم
		هدا.خدحالة({
			صفحة: 'تطويرئيسية' ئدا جلسة.معرفمشروع وئلا 'ملخاصرئيسية'
		})؛
	تم
تم

ئعلن مدخل ():
	عنصرمخصص.سججل('تطبيق'، تطبيق)؛
تم
